<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="shortcut icon" href="images/favicon.png" type="image/x-icon">

	<title>用户中心</title>

	<!-- Fonts -->
	<link rel="stylesheet" href="assets/fonts/Lato/Lato.css">

	<!-- Icons -->
	<link rel="stylesheet" href="assets/fonts/flaticon/flaticon.css">
	<link rel="stylesheet" href="assets/fonts/webfont/css/materialdesignicons.min.css">

	<!-- Libs -->
	<link rel="stylesheet" href="libs/bootstrap-4.3.1/css/bootstrap.min.css">
	<link rel="stylesheet" href="libs/select2/css/select2.min.css">
	<link rel="stylesheet" href="libs/slick/slick.css">

	<!-- Theme -->
	<link rel="stylesheet" href="assets/css/style.css">
	<meta name="theme-color" content="#ECECEC">

	<!-- jquery -->
	<script type="text/javascript" src="/js/jquery.min.js"></script>
	<!-- bootstrap -->
	<link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css" />
	<script type="text/javascript" src="/bootstrap/js/bootstrap.min.js"></script>
	<!-- jquery-validator -->
	<script type="text/javascript" src="/jquery-validation/jquery.validate.min.js"></script>
	<script type="text/javascript" src="/jquery-validation/localization/messages_zh.min.js"></script>
	<!-- layer -->
	<script type="text/javascript" src="/layer/layer.js"></script>
	<!-- md5.js -->
	<script type="text/javascript" src="/js/md5.min.js"></script>
	<!-- common.js -->
	<script type="text/javascript" src="/js/common.js"></script>

	<script>
		var flag=1;  //默认按钮是修改用户信息
		var flag1=1;  //默认按钮是修改用户信息
		var id;


		window.onload(requestData());

		function requestData(){
			$.ajax({
				url: "/user/info",
				type: "get",
				// dataType: "json",
				success:function(data){
					if(data.code == 0){
						console.log(data);
						// render(data.data);
						user=data.data;
						render(data.data);
						// showData(data.data);//我们仅做数据展示
					}else{
						layer.msg(data.msg);
					}
				},
			error: function(msg){
			alert("ajax连接异常："+msg);
			}
			});
			}
		function render(detail){

			$("#nickName").text(detail.nickname);
			$("#mobile").text(detail.id);
			$("#address").text(detail.address);
			id = detail.id;
			// $("#goodsImg").attr("src", goods.goodsImg);
			// $("#orderPrice").text(order.goodsPrice);
			// $("#createDate").text(new Date(order.createDate).format("yyyy-MM-dd hh:mm:ss"));
			// var status = "";
			// if(order.status == 0){
			// 	status = "未支付"
			// }else if(order.status == 1){
			// 	status = "待发货";
			// }
			// $("#orderStatus").text(status);

		}
		function editUser(){
			var e=document.getElementById("edit");
			var a = document.getElementById("address");
			var u =document.getElementById("nickName");
			var m = document.getElementById("mobile");

			if(flag===1) {
				var initialValue = u.innerHTML;
				u.innerHTML = `<input value=${initialValue} id="nickname"></input>`;
				var initialValue = a.innerHTML;
				a.innerHTML = `<input value=${initialValue} id="address1"></input>`;
				e.innerHTML="保存";
				flag=0;
			}
			else{
				console.log('a',(m.innerHTML),a,$("#address1").val(),$("#nickname").val())
				$.ajax({
					url: "/user/updateInfo",
					type: "post",
					data:{
						id:id,
						address:$("#address1").val(),
						nickname:$("#nickname").val(),
					},
					// dataType: "json",
					success:function(data){
						if(data.code == 0){

							/*console.log(data,$("#address1").val());
							// render(data.data);
							a.innerHTML=$("#address1").val();
							u.innerHTML=$("#nickname").val();*/
							flag=1;
							location.reload();
						}else{
							layer.msg(data.msg);
						}
					},
					error: function(msg){
						alert("ajax连接异常："+msg);
					}
				});
				render(data.data);
			}
		}

		function editPassword(){

			window.location.href="/password.htm";

		}

	</script>

</head>


<body>


	<div class="head-line"></div>


	<div id="head"></div>

	<div class="page-wrap cart shop">
		<!-- Breadcrumbs -->
		<nav aria-label="breadcrumb" class="page-breadcrumb">
			<div class="container">
				<ol class="breadcrumb">
					<li class="breadcrumb-item"><a href="/">主页</a></li>
					<li class="breadcrumb-item active" aria-current="page">个人中心</li>
				</ol>
			</div>
		</nav>

		<div class="page-content">
			<main class="main-content">
				<div class="container">
					<h1 class="page-title h3 text-center">个人中心</h1>
					<button type="button" class="btn btn-primary mr-1 mb-3" onclick="editUser()" id="edit">修改个人信息</button>
					<button type="button" class="btn btn-primary mr-1 mb-3" onclick="editPassword()" id="password">修改密码</button>

					<table  id="ordersTable">
<!--						<thead>-->
<!--						<tr>-->
<!--							<th class="product-thumbnail">商品</th>-->
<!--							<th class="product-name">&nbsp;</th>-->
<!--							<th class="product-price">价格</th>-->
<!--							<th class="product-quantity">数量</th>-->
<!--							<th class="product-remove">&nbsp;</th>-->
<!--							<th class="product-subtotal">总计</th>-->
<!--						</tr>-->
<!--						</thead>-->
<!--						<tbody>-->
						<tr>
							<td>
								用户名
							</td>
							<td id="nickName"></td>
						</tr>
						<tr>
							<td>
								手机号
							</td>
							<td id="mobile"></td>
						</tr>
						<tr>
							<td>
								收货地址
							</td>
							<td id="address"></td>
						</tr>






<!--						<tr class="cart-item">-->
<!--							<td class="product-thumbnail">-->
<!--								<a href="single-product.htm">-->
<!--									<img width="170" height="240" src="images/cart1.jpg" alt="" class="attachment-shop_thumbnail"/>-->
<!--								</a>-->
<!--							</td>-->
<!--							<td class="product-name">-->
<!--								<h4><a href="single-product.htm" id="goodsName">haha </a></h4>-->
<!--							</td>-->
<!--							<td class="product-price" data-title="Price: ">-->
<!--								<span class="amount"  id="goodsPrice">商品价格</span>-->
<!--							</td>-->
<!--							<td class="product-quantity" data-title="Quantity: ">-->
<!--								<div class="quantity">-->
<!--									<select class="select-style js-select2">-->
<!--										<option value="usd">1</option>-->
<!--										<option value="eur">2</option>-->
<!--										<option value="gbr">3</option>-->
<!--									</select>-->
<!--								</div>-->
<!--							</td>-->
<!--							<td class="product-remove">-->
<!--								<button class="remove">-->
<!--									<i class="flaticon-waste-can"></i>-->
<!--									<span class="remove__text">删除</span>-->
<!--								</button>-->
<!--							</td>-->
<!--							<td class="product-subtotal" data-title="Total: ">-->
<!--								<span class="amount">¥56.00</span>-->
<!--							</td>-->
<!--						</tr>-->
<!--						<tr class="cart-item">-->
<!--							<td class="product-thumbnail">-->
<!--								<a href="single-product.htm">-->
<!--									<img width="170" height="240" src="images/cart2.jpg" alt="" class="attachment-shop_thumbnail"/>-->
<!--								</a>-->
<!--							</td>-->
<!--							<td class="product-name">-->
<!--								<h4><a href="single-product.htm">美度男士手表</a></h4>-->
<!--							</td>-->
<!--							<td class="product-price" data-title="Price:">-->
<!--								<span class="amount">¥6500.00</span>-->
<!--							</td>-->
<!--							<td class="product-quantity" data-title="Quantity:">-->
<!--								<div class="quantity">-->
<!--									<select class="select-style">-->
<!--										<option value="usd">1</option>-->
<!--										<option value="eur">2</option>-->
<!--										<option value="gbr">3</option>-->
<!--									</select>-->
<!--								</div>-->
<!--							</td>-->
<!--							<td class="product-remove">-->
<!--								<button class="remove">-->
<!--									<i class="flaticon-waste-can"></i>-->
<!--									<span class="remove__text">删除</span>-->
<!--								</button>-->
<!--							</td>-->
<!--							<td class="product-subtotal" data-title="Total:">-->
<!--								<span class="amount">¥6500.00</span>-->
<!--							</td>-->
						</tr>
						</tbody>
					</table>

<!--					<div class="row justify-content-between">-->
<!--						<div class="col-lg-3">-->
<!--							<h3 class="simple-heading mb-4">订单总额</h3>-->

<!--							<form action="/" class="calc-shipping">-->
<!--								<div class="form-group">-->
<!--									<select class="form-control js-select2" data-placeholder="Choose country">-->
<!--										<option value="">选择 国家</option> &lt;!&ndash; Require for select placeholder &ndash;&gt;-->
<!--										<option value="Canada">加拿大</option>-->
<!--										<option value="China">中国</option>-->
<!--										<option value="Ukraine">英国</option>-->
<!--										<option value="USA">美国</option>-->
<!--									</select>-->
<!--								</div>-->
<!--								<div class="form-group">-->
<!--									<select class="form-control js-select2" data-placeholder="Select state">-->
<!--										<option value="">选择省份</option> &lt;!&ndash; Require for select placeholder &ndash;&gt;-->
<!--										<option value="Arizona">湖北</option>-->
<!--										<option value="California">广东</option>-->
<!--									</select>-->
<!--								</div>-->
<!--								<div class="form-group">-->
<!--									<input type="text" class="form-control" placeholder="Zip / Postal code">-->
<!--								</div>-->
<!--								<div class="form-submit">-->
<!--									<input type="submit" class="btn btn-outline-primary btn-block" name="update_cart" value="Calculate" />-->
<!--								</div>-->
<!--							</form>-->
<!--						</div>-->

<!--						<div class="col-lg-6 cart-total">-->
<!--							<div class="cart-subtotal d-flex justify-content-between align-items-center">-->
<!--								<span>总计</span>-->
<!--								<span>¥6556.00</span>-->
<!--							</div>-->

<!--							<div class="cart-total__btns text-lg-right">-->
<!--								<button class="btn btn-outline-primary btn-lg cart-update-btn">更新&nbsp;</button>-->
<!--								<a href="checkout.html" class="btn btn-primary btn-lg cart-checkout-btn">确认下单</a>-->
<!--							</div>-->
<!--						</div>-->
<!--					</div>-->

				</div>
			</main>
		</div>
	</div>

	<div id="footer"></div>
	<script type="text/javascript">
		$('#head').load('header.html');
		$('#footer').load('footer.html');
	</script>

	<!-- Libs -->
	<script src="libs/jquery-2.2.3.min.js"></script>
	<script src="libs/bootstrap-4.3.1/js/bootstrap.min.js"></script>
	<script src="libs/select2/js/select2.min.js"></script>
	<script src="libs/slick/slick.min.js"></script>

	<!-- Theme -->
	<script src="assets/js/custom.js"></script>
</body>
</html>